<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dockerfile_distro (dockerfile-opam.Dockerfile_distro)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">dockerfile-opam</a> &#x00BB; Dockerfile_distro</nav><h1>Module <code>Dockerfile_distro</code></h1><p>Run Opam commands across a matrix of Docker containers. Each of these containers represents a different version of OCaml, Opam and an OS distribution (such as Debian or Alpine).</p><nav class="toc"><ul><li><a href="#known-distributions-and-ocaml-variants">Known distributions and OCaml variants</a></li><li><a href="#docker-hub-addresses">Docker Hub addresses</a></li><li><a href="#cpu-architectures">CPU architectures</a></li><li><a href="#opam-build-infrastructure-support">Opam build infrastructure support</a></li></ul></nav></header><section><header><h3 id="known-distributions-and-ocaml-variants"><a href="#known-distributions-and-ocaml-variants" class="anchor"></a>Known distributions and OCaml variants</h3></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code> = <code>[ </code><table class="variant"><tr id="type-t.Alpine" class="anchored"><td class="def constructor"><a href="#type-t.Alpine" class="anchor"></a><code>| </code><code>`Alpine <span class="keyword">of</span> [ `V3_3 | `V3_4 | `V3_5 | `V3_6 | `V3_7 | `V3_8 | `V3_9 | `Latest ]</code></td></tr><tr id="type-t.CentOS" class="anchored"><td class="def constructor"><a href="#type-t.CentOS" class="anchor"></a><code>| </code><code>`CentOS <span class="keyword">of</span> [ `V6 | `V7 | `Latest ]</code></td></tr><tr id="type-t.Debian" class="anchored"><td class="def constructor"><a href="#type-t.Debian" class="anchor"></a><code>| </code><code>`Debian <span class="keyword">of</span> [ `V9 | `V8 | `V7 | `Stable | `Testing | `Unstable ]</code></td></tr><tr id="type-t.Fedora" class="anchored"><td class="def constructor"><a href="#type-t.Fedora" class="anchor"></a><code>| </code><code>`Fedora <span class="keyword">of</span> [ `V21 | `V22 | `V23 | `V24 | `V25 | `V26 | `V27 | `V28 | `V29 | `Latest ]</code></td></tr><tr id="type-t.OracleLinux" class="anchored"><td class="def constructor"><a href="#type-t.OracleLinux" class="anchor"></a><code>| </code><code>`OracleLinux <span class="keyword">of</span> [ `V7 | `Latest ]</code></td></tr><tr id="type-t.OpenSUSE" class="anchored"><td class="def constructor"><a href="#type-t.OpenSUSE" class="anchor"></a><code>| </code><code>`OpenSUSE <span class="keyword">of</span> [ `V42_1 | `V42_2 | `V42_3 | `V15_0 | `Latest ]</code></td></tr><tr id="type-t.Ubuntu" class="anchored"><td class="def constructor"><a href="#type-t.Ubuntu" class="anchor"></a><code>| </code><code>`Ubuntu <span class="keyword">of</span> [ `V12_04 | `V14_04 | `V15_04 | `V15_10 | `V16_04 | `V16_10 | `V17_04 | `V17_10 | `V18_04 | `V18_10 | `LTS | `Latest ]</code></td></tr></table><code> ]</code></dt><dd><p>Supported Docker container distributions</p></dd></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec value" id="val-t_of_sexp"><a href="#val-t_of_sexp" class="anchor"></a><code><span class="keyword">val</span> t_of_sexp : <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-__t_of_sexp__"><a href="#val-__t_of_sexp__" class="anchor"></a><code><span class="keyword">val</span> __t_of_sexp__ : <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a></code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare a b</code> is a lexical comparison function for <a href="index.html#type-t"><code>t</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-resolve_alias"><a href="#val-resolve_alias" class="anchor"></a><code><span class="keyword">val</span> resolve_alias : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>resolve_alias t</code> will resolve <code>t</code> into a concrete version. This removes versions such as <code>Latest</code>.</p></dd></dl><dl><dt class="spec value" id="val-distros"><a href="#val-distros" class="anchor"></a><code><span class="keyword">val</span> distros : <a href="index.html#type-t">t</a> list</code></dt><dd><p>Enumeration of the supported Docker container distributions</p></dd></dl><dl><dt class="spec value" id="val-latest_distros"><a href="#val-latest_distros" class="anchor"></a><code><span class="keyword">val</span> latest_distros : <a href="index.html#type-t">t</a> list</code></dt><dd><p>Enumeration of the latest stable (ideally LTS) supported distributions.</p></dd></dl><dl><dt class="spec value" id="val-master_distro"><a href="#val-master_distro" class="anchor"></a><code><span class="keyword">val</span> master_distro : <a href="index.html#type-t">t</a></code></dt><dd><p>The distribution that is the top-level alias for the <code>latest</code> tag in the <code>ocaml/opam2</code> Docker Hub build.</p></dd></dl><dl><dt class="spec value" id="val-builtin_ocaml_of_distro"><a href="#val-builtin_ocaml_of_distro" class="anchor"></a><code><span class="keyword">val</span> builtin_ocaml_of_distro : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string option</code></dt><dd><p><code>builtin_ocaml_of_distro t</code> will return the OCaml version supplied with the distribution packaging, and <code>None</code> if there is no supported version.</p></dd></dl><dl><dt class="spec value" id="val-human_readable_string_of_distro"><a href="#val-human_readable_string_of_distro" class="anchor"></a><code><span class="keyword">val</span> human_readable_string_of_distro : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>human_readable_string_of_distro t</code> returns a human readable version of the distribution tag, including version information.</p></dd></dl><dl><dt class="spec value" id="val-human_readable_short_string_of_distro"><a href="#val-human_readable_short_string_of_distro" class="anchor"></a><code><span class="keyword">val</span> human_readable_short_string_of_distro : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>human_readable_short_string_of_distro t</code> returns a human readable short version of the distribution tag, excluding version information.</p></dd></dl><dl><dt class="spec type" id="type-package_manager"><a href="#type-package_manager" class="anchor"></a><code><span class="keyword">type</span> package_manager</code> = <code>[ </code><table class="variant"><tr id="type-package_manager.Apk" class="anchored"><td class="def constructor"><a href="#type-package_manager.Apk" class="anchor"></a><code>| </code><code>`Apk</code></td><td class="doc"><p>Alpine Apk</p></td></tr><tr id="type-package_manager.Apt" class="anchored"><td class="def constructor"><a href="#type-package_manager.Apt" class="anchor"></a><code>| </code><code>`Apt</code></td><td class="doc"><p>Debian Apt</p></td></tr><tr id="type-package_manager.Yum" class="anchored"><td class="def constructor"><a href="#type-package_manager.Yum" class="anchor"></a><code>| </code><code>`Yum</code></td><td class="doc"><p>Fedora Yum</p></td></tr><tr id="type-package_manager.Zypper" class="anchored"><td class="def constructor"><a href="#type-package_manager.Zypper" class="anchor"></a><code>| </code><code>`Zypper</code></td><td class="doc"><p>OpenSUSE Zypper</p></td></tr></table><code> ]</code></dt><dd><p>The package manager used by a distro.</p></dd></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec value" id="val-package_manager_of_sexp"><a href="#val-package_manager_of_sexp" class="anchor"></a><code><span class="keyword">val</span> package_manager_of_sexp : <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a> <span>&#45;&gt;</span> <a href="index.html#type-package_manager">package_manager</a></code></dt><dt class="spec value" id="val-__package_manager_of_sexp__"><a href="#val-__package_manager_of_sexp__" class="anchor"></a><code><span class="keyword">val</span> __package_manager_of_sexp__ : <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a> <span>&#45;&gt;</span> <a href="index.html#type-package_manager">package_manager</a></code></dt><dt class="spec value" id="val-sexp_of_package_manager"><a href="#val-sexp_of_package_manager" class="anchor"></a><code><span class="keyword">val</span> sexp_of_package_manager : <a href="index.html#type-package_manager">package_manager</a> <span>&#45;&gt;</span> <a href="../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a></code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-package_manager"><a href="#val-package_manager" class="anchor"></a><code><span class="keyword">val</span> package_manager : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-package_manager">package_manager</a></code></dt><dd><p><code>package_manager t</code> returns the type of package manager used by that distribution. Many derived distributions (such as OracleLinux) share the same package manager from a base distribution (such as CentOS).</p></dd></dl></section><section><header><h3 id="docker-hub-addresses"><a href="#docker-hub-addresses" class="anchor"></a>Docker Hub addresses</h3></header><dl><dt class="spec value" id="val-tag_of_distro"><a href="#val-tag_of_distro" class="anchor"></a><code><span class="keyword">val</span> tag_of_distro : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>tag_of_distro t</code> convert a distribution <code>t</code> to a Docker Hub tag.</p></dd></dl><dl><dt class="spec value" id="val-distro_of_tag"><a href="#val-distro_of_tag" class="anchor"></a><code><span class="keyword">val</span> distro_of_tag : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> option</code></dt><dd><p><code>distro_of_tag s</code> parses <code>s</code> into a <a href="index.html#type-t"><code>t</code></a> distribution, and <code>None</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-latest_tag_of_distro"><a href="#val-latest_tag_of_distro" class="anchor"></a><code><span class="keyword">val</span> latest_tag_of_distro : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>latest_tag_of_distro distro</code> will generate a Docker Hub tag that is a convenient short form for the latest stable release of a particular distribution. This tag will be regularly rewritten to point to any new releases of the distribution.</p></dd></dl><dl><dt class="spec value" id="val-base_distro_tag"><a href="#val-base_distro_tag" class="anchor"></a><code><span class="keyword">val</span> base_distro_tag : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string * string</code></dt><dd><p><code>base_distro_tag t</code> will return a tuple of a Docker Hub user/repository and tag for which the base image of a distribution can be found (e.g. <code>opensuse/leap</code>,<code>15.0</code> which maps to <code>opensuse/leap:15.0</code> on the Docker Hub). This base image is in turn can be used to generate opam and other OCaml tool Dockerfiles.</p></dd></dl></section><section><header><h3 id="cpu-architectures"><a href="#cpu-architectures" class="anchor"></a>CPU architectures</h3></header><dl><dt class="spec value" id="val-distro_arches"><a href="#val-distro_arches" class="anchor"></a><code><span class="keyword">val</span> distro_arches : <a href="../../ocaml-version/Ocaml_version/index.html#type-t">Ocaml_version.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../ocaml-version/Ocaml_version/index.html#type-arch">Ocaml_version.arch</a> list</code></dt><dd><p><code>distro_arches ov t</code> returns the list of architectures that distribution <code>t</code> is supported on for OCaml compiler version <code>ov</code></p></dd></dl><dl><dt class="spec value" id="val-distro_supported_on"><a href="#val-distro_supported_on" class="anchor"></a><code><span class="keyword">val</span> distro_supported_on : <a href="../../ocaml-version/Ocaml_version/index.html#type-arch">Ocaml_version.arch</a> <span>&#45;&gt;</span> <a href="../../ocaml-version/Ocaml_version/index.html#type-t">Ocaml_version.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>distro_supported_on arch ov distro</code> returns <code>true</code> if the combination of CPU <code>arch</code>, compiler version <code>ov</code> is available on the distribution <code>distro</code>.</p></dd></dl></section><section><header><h3 id="opam-build-infrastructure-support"><a href="#opam-build-infrastructure-support" class="anchor"></a>Opam build infrastructure support</h3></header><dl><dt class="spec value" id="val-active_distros"><a href="#val-active_distros" class="anchor"></a><code><span class="keyword">val</span> active_distros : <a href="../../ocaml-version/Ocaml_version/index.html#type-arch">Ocaml_version.arch</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p><code>active_distros arch</code> returns the list of currently supported distributions in the opam build infrastructure. Distributions that are end-of-life upstream will rotate out of this list regularly.</p></dd></dl><dl><dt class="spec value" id="val-active_tier1_distros"><a href="#val-active_tier1_distros" class="anchor"></a><code><span class="keyword">val</span> active_tier1_distros : <a href="../../ocaml-version/Ocaml_version/index.html#type-arch">Ocaml_version.arch</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p>Tier 1 distributions are those supported for the full matrix of compiler versions in the opam build infrastructure.</p></dd></dl><dl><dt class="spec value" id="val-active_tier2_distros"><a href="#val-active_tier2_distros" class="anchor"></a><code><span class="keyword">val</span> active_tier2_distros : <a href="../../ocaml-version/Ocaml_version/index.html#type-arch">Ocaml_version.arch</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> list</code></dt><dd><p>Tier 2 distributions are those supported for a limited set of compiler versions in the opam build infrastructure.</p></dd></dl></section></div></body></html>